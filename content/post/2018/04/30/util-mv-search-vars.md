+++
title = "変数・スイッチの選択をテキスト検索から行うツール"
slug = "util-mv-search-vars"
date = 2018-04-30T09:18:41+09:00
categories = ["技術"]
tags = ["RPGツクール", "java", "javafx", "vbs", "gui", "ツール", "配布", "検索"]
+++

はじめに
------------------------------------------------------------------------------

この記事では移行前のブログで紹介していた自作のツールを再紹介しています。  
紹介するツールは「MVVariablesSearcher」というツクールMV専用の変数、スイッチ検索
ツールです。

目的
------------------------------------------------------------------------------

ツクールMVでは変数やスイッチを検索する機能がありませんでした。(作成した当時)
なので、単語や正規表現でテキストを検索できるようにしたいと考えました。

***現在公式が簡易な検索機能を提供しているのでこちらのツールは非推奨です***

デモ
------------------------------------------------------------------------------

![MVVariablesSearcherのデモ](/img/2018/04/30/util-mv-search-vars/mvvs01.gif)

ご覧の通り正規表現で検索し、ツクールMVを操作して対象の変数を検索しています。

ダウンロード
------------------------------------------------------------------------------

https://github.com/jiro4989/MVVariablesSearcher/releases

使い方・利用規約・ソースコード
------------------------------------------------------------------------------

**VBScriptを一部使用しているのでWindowsでしか動作しません。**

https://github.com/jiro4989/MVVariablesSearcher

実装
------------------------------------------------------------------------------

仕組みは単純で、GUIをJavaFX、ツクールの操作をVBSで行っています。

GUIでプロジェクトの変数一覧を取得して検索し、タップしたリストのインデックスをVBS
に渡してVBSからツクールMVを操作しています。

現状下記の問題があります。

- Windows環境でしか使えない
- 日本語環境じゃないと動作しない
- CPU負荷が高いと選択に失敗するかもしれない

余談
------------------------------------------------------------------------------

すでに標準が検索ツールを追加実装してくださっているので、そちらを使うのが無難だと
思います。
